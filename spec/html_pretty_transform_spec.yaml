single tags:
  converts simplest html block:
    in:  <html></html>
    out: <html></html>

  quashes beginning whitespace:
    in: |
      <html>
      	  </html>
    out: |
      <html>
      </html>

  quashes trailing whitespace:
    in: |
      <html>      
      </html>	
    out: |
      <html>
      </html>

  collapses whitespace within tags:
    in:  <html  foo='bar'	tony='hawk'></html>
    out: <html foo='bar' tony='hawk'></html>

  quashes whitespace at the tag extremes:
    in:  <    html	></html   >
    out: <html></html>

  quashes blank lines:
    in: |
      <html>
          
      	

      </html>
    out: |
      <html>
      </html>

  collapses spaces between tags:
    # HTML text nodes have meanings so we shouldn't just quash them.
    in:  <html> 	  </html>
    out: <html> </html>

nested tags:
  indent with outstanding opening tag:
    in: |
      <html>
      <hi>
      </hi>
      </html>
    out: |
      <html>
        <hi>
        </hi>
      </html>

  indent with text on either side:
    # HTML text nodes have meanings so we can't just quash them.
    in: |
      <html>
      <spam>abc
      123</spam>
      </html>
    out: |
      <html>
        <spam>abc
        123</spam>
      </html>

  indent with multiple opening tags:
    in: |
      <html>
      <hi>
      <bye>
      </bye>
      </hi>
      </html>

    out: |
      <html>
        <hi>
          <bye>
          </bye>
        </hi>
      </html>

  indent with multiple opening tags on one line:
    in: |
      <html><hi><bye>
      </bye>
      </hi>
      </html>

    out: |
      <html><hi><bye>
          </bye>
        </hi>
      </html>

  do not indent further with self closing tags:
    in: |
      <html>
      <hi />
      <bye />
      </html>
    out: |
      <html>
        <hi />
        <bye />
      </html>

  indents hrefs:
    in: |
      <a href='http://www.google.com'>
      something
      </a>
    out: |
      <a href='http://www.google.com'>
        something
      </a>

special:
  do not indent from DOCTYPE:
    in: |
      <!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'
        'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
          <html></html>
    out: |
      <!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Transitional//EN'
        'http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd'>
      <html></html>

  do not indent from HTML5:
    in: |
      <!DOCTYPE html>
          <html></html>
    out: |
      <!DOCTYPE html>
      <html></html>

  does not affect comments:
    in: |
      <!-- comment
            <html> -->
        <html>
        </html>
    out: |
      <!-- comment
            <html> -->
      <html>
      </html>

  does not affect script:
    in: |
      <script type='text/javascript'>
        if(0 == 1) {
          raise 'End of the world!'
        }
      </script>
        <html>
        </html>
    out: |
      <script type='text/javascript'>
        if(0 == 1) {
          raise 'End of the world!'
        }
      </script>
      <html>
      </html>

  does not affect style:
    in: |
      <style type='text/css'>
        html {
          position: absolute;
        }
      </style>
        <html>
        </html>
    out: |
      <style type='text/css'>
        html {
          position: absolute;
        }
      </style>
      <html>
      </html>

malformed:
  indents correctly even after descender fails:
    in: |
      <html>
      </title>
      </head>
      <body>
      <p></p>
      </body>
      </html>
    out: |
      <html>
      </title>
      </head>
      <body>
        <p></p>
      </body>
      </html>
